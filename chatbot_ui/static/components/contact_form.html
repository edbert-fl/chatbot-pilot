<div class="row">
  <div class="field"><label>Name</label><input id="cf_name"/></div>
  <div class="field"><label>Email</label><input id="cf_email"/></div>
  <div class="field" style="flex:1"><label>Company</label><input id="cf_company"/></div>
  <div class="field" style="flex-basis:100%"><label>Message (ready to send)</label><textarea id="cf_note" rows="4" placeholder="Your message will be generated based on your selections..."></textarea></div>
  <div><button class="btn btn-primary" id="cf_submit">Submit</button></div>
</div>
<script>
  (function bindContact(){
    const root = document.currentScript.parentElement;
    const submit = root.querySelector('#cf_submit');
    const noteField = root.querySelector('#cf_note');
    
    // Message will be pre-filled by the main app.js
    
    submit.addEventListener('click', async () => {
      const payload = {
        contact_name: root.querySelector('#cf_name').value,
        contact_email: root.querySelector('#cf_email').value,
        contact_company: root.querySelector('#cf_company').value,
        contact_note: root.querySelector('#cf_note').value,
      };
      const tpl = root.getAttribute('data-prompt-template');
      if (tpl && typeof window.setPromptAndSend === 'function') {
        const prompt = tpl
          .replaceAll('{name}', payload.contact_name || '')
          .replaceAll('{email}', payload.contact_email || '')
          .replaceAll('{company}', payload.contact_company || '')
          .replaceAll('{note}', payload.contact_note || '');
        window.setPromptAndSend(prompt);
        return;
      }
      if (typeof window.sendFollowupSelection === 'function') {
        await window.sendFollowupSelection({ contact: payload });
      }
    });
  })();
</script>

